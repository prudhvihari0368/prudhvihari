<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Table Example</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <style>
        body {
            text-align: center;
        }

        table {
            width: 50%;
            border-collapse: collapse;
            margin: 20px;
            margin: auto;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
</head>

<body>
    <h2>Table Example</h2>

    <table>
        <thead>
            <tr>
                <th>Description</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <p>Diamond</p>
                    <p>Platinum</p>
                    <p>Gold</p>
                    <p>Bronze</p>
                </td>
                <td>
                    <p id="diamond-amount"></p>
                    <p id="platinum-amount"></p>
                    <p id="gold-amount"></p>
                    <p id="bronze-amount"></p>
                </td>
            </tr>
            <tr>
                <td>Discount - Early bird</td>
                <td>
                    <p id="early-bird-discount"></p>
                </td>
            </tr>
            <tr>
                <td>Discount - Returning customer</td>
                <td>
                    <p id="returning-customer-discount"></p>
                </td>
            </tr>
            <tr>
                <td>Children discount rate</td>
                <td>
                    <p id="children-discount"></p>
                </td>
            </tr>
            <tr>
                <td>Selected Seats</td>
                <td id="selected-seats"></td>
            </tr>
            <tr>
                <td>Total</td>
                <td id="total-amount"></td>
            </tr>
        </tbody>
    </table>
    <br />
    <button type="submit" id="proceedButton">Pay >></button>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Function to retrieve data from local storage
            function retrieveDataFromLocalStorage() {
                const storedData = localStorage.getItem("selectedSeatsData");
                return storedData ? JSON.parse(storedData) : null;
            }

            // Function to display the retrieved data on the page
            function displayData() {
                const storedData = retrieveDataFromLocalStorage();

                if (storedData) {
                    // Update the content of the table based on the stored data
                    const seatPrices = {
                        Diamond: 89,
                        Platinum: 79,
                        Gold: 65,
                        Bronze: 50,
                    };

                    // Configurable discount values
                    const discountAmounts = {
                        "early-bird": 65,  // You can change this value
                        "returning-customer": 50,  // You can change this value
                        "children-discount": 25,  // You can change this value
                    };

                    const tableBody = document.querySelector("tbody");
                    const diamondAmount = document.getElementById("diamond-amount");
                    const platinumAmount = document.getElementById("platinum-amount");
                    const goldAmount = document.getElementById("gold-amount");
                    const bronzeAmount = document.getElementById("bronze-amount");
                    const earlyBirdDiscount = document.getElementById(
                        "early-bird-discount"
                    );
                    const returningCustomerDiscount = document.getElementById(
                        "returning-customer-discount"
                    );
                    const childrenDiscount =
                        document.getElementById("children-discount");
                    const selectedSeatsCell = document.getElementById("selected-seats");
                    const totalAmount = document.getElementById("total-amount");

                    let totalCost = 0;
                    let selectedSeatsList = [];

                    // Iterate over each category in the stored data
                    for (const category in storedData) {
                        const seats = storedData[category];
                        const costPerSeat = seatPrices[category];
                        const categoryCost = seats.length * costPerSeat;
                        totalCost += categoryCost;

                        // Update the corresponding table cell with the calculated cost
                        switch (category) {
                            case "Diamond":
                                diamondAmount.textContent = `$${categoryCost}`;
                                break;
                            case "Platinum":
                                platinumAmount.textContent = `$${categoryCost}`;
                                break;
                            case "Gold":
                                goldAmount.textContent = `$${categoryCost}`;
                                break;
                            case "Bronze":
                                bronzeAmount.textContent = `$${categoryCost}`;
                                break;
                            default:
                                break;
                        }

                        // Build a list of selected seats
                        const formattedSeats = seats.map(seat => `${seat.row}-${seat.seat}`);
                        selectedSeatsList.push(`${category}: ${formattedSeats.join(", ")}`);
                    }

                    // Apply any additional discounts
                    let totalDiscount = 0;

                    // Early bird discount
                    totalDiscount += discountAmounts["early-bird"];

                    // Returning customer discount
                    totalDiscount += discountAmounts["returning-customer"];

                    // Children discount
                    totalDiscount += discountAmounts["children-discount"];

                    // Display the discounts
                    earlyBirdDiscount.textContent = `$${discountAmounts["early-bird"]}`;
                    returningCustomerDiscount.textContent = `$${discountAmounts["returning-customer"]}`;
                    childrenDiscount.textContent = `$${discountAmounts["children-discount"]}`;

                    // Display the list of selected seats
                    selectedSeatsCell.textContent = selectedSeatsList.join(", ");

                    // Calculate and display the total amount after applying discounts
                    totalAmount.textContent = `$${Math.max(
                        totalCost - totalDiscount,
                        0
                    )}`;
                }
            }

            // Call the displayData function to show the retrieved data on the page
            displayData();
        });
    </script>
</body>

</html>
